(function(){function m(p,q,e){function a(c,d){if(!q[c]){if(!p[c]){var k="function"==typeof require&&require;if(!d&&k)return k(c,!0);if(b)return b(c,!0);d=Error("Cannot find module '"+c+"'");throw d.code="MODULE_NOT_FOUND",d;}d=q[c]={exports:{}};p[c][0].call(d.exports,function(b){return a(p[c][1][b]||b)},d,d.exports,m,p,q,e)}return q[c].exports}for(var b="function"==typeof require&&require,d=0;d<e.length;d++)a(e[d]);return a}return m})()({1:[function(m,p,q){},{}],2:[function(m,p,q){var e={generateIdentifier:function(){return Math.random().toString(36).substr(2,
10)}};e.localCName=e.generateIdentifier();e.splitLines=function(a){return a.trim().split("\n").map(function(a){return a.trim()})};e.splitSections=function(a){return a.split("\nm=").map(function(a,d){return(0<d?"m="+a:a).trim()+"\r\n"})};e.getDescription=function(a){return(a=e.splitSections(a))&&a[0]};e.getMediaSections=function(a){a=e.splitSections(a);a.shift();return a};e.matchPrefix=function(a,b){return e.splitLines(a).filter(function(a){return 0===a.indexOf(b)})};e.parseCandidate=function(a){a=
0===a.indexOf("a=candidate:")?a.substring(12).split(" "):a.substring(10).split(" ");for(var b={foundation:a[0],component:parseInt(a[1],10),protocol:a[2].toLowerCase(),priority:parseInt(a[3],10),ip:a[4],address:a[4],port:parseInt(a[5],10),type:a[7]},d=8;d<a.length;d+=2)switch(a[d]){case "raddr":b.relatedAddress=a[d+1];break;case "rport":b.relatedPort=parseInt(a[d+1],10);break;case "tcptype":b.tcpType=a[d+1];break;case "ufrag":b.ufrag=a[d+1];b.usernameFragment=a[d+1];break;default:b[a[d]]=a[d+1]}return b};
e.writeCandidate=function(a){var b=[];b.push(a.foundation);b.push(a.component);b.push(a.protocol.toUpperCase());b.push(a.priority);b.push(a.address||a.ip);b.push(a.port);var d=a.type;b.push("typ");b.push(d);"host"!==d&&a.relatedAddress&&a.relatedPort&&(b.push("raddr"),b.push(a.relatedAddress),b.push("rport"),b.push(a.relatedPort));a.tcpType&&"tcp"===a.protocol.toLowerCase()&&(b.push("tcptype"),b.push(a.tcpType));if(a.usernameFragment||a.ufrag)b.push("ufrag"),b.push(a.usernameFragment||a.ufrag);return"candidate:"+
b.join(" ")};e.parseIceOptions=function(a){return a.substr(14).split(" ")};e.parseRtpMap=function(a){a=a.substr(9).split(" ");var b={payloadType:parseInt(a.shift(),10)};a=a[0].split("/");b.name=a[0];b.clockRate=parseInt(a[1],10);b.channels=3===a.length?parseInt(a[2],10):1;b.numChannels=b.channels;return b};e.writeRtpMap=function(a){var b=a.payloadType;void 0!==a.preferredPayloadType&&(b=a.preferredPayloadType);var d=a.channels||a.numChannels||1;return"a=rtpmap:"+b+" "+a.name+"/"+a.clockRate+(1!==
d?"/"+d:"")+"\r\n"};e.parseExtmap=function(a){a=a.substr(9).split(" ");return{id:parseInt(a[0],10),direction:0<a[0].indexOf("/")?a[0].split("/")[1]:"sendrecv",uri:a[1]}};e.writeExtmap=function(a){return"a=extmap:"+(a.id||a.preferredId)+(a.direction&&"sendrecv"!==a.direction?"/"+a.direction:"")+" "+a.uri+"\r\n"};e.parseFmtp=function(a){for(var b={},d=a.substr(a.indexOf(" ")+1).split(";"),c=0;c<d.length;c++)a=d[c].trim().split("="),b[a[0].trim()]=a[1];return b};e.writeFmtp=function(a){var b="",d=a.payloadType;
void 0!==a.preferredPayloadType&&(d=a.preferredPayloadType);if(a.parameters&&Object.keys(a.parameters).length){var c=[];Object.keys(a.parameters).forEach(function(b){a.parameters[b]?c.push(b+"="+a.parameters[b]):c.push(b)});b+="a=fmtp:"+d+" "+c.join(";")+"\r\n"}return b};e.parseRtcpFb=function(a){a=a.substr(a.indexOf(" ")+1).split(" ");return{type:a.shift(),parameter:a.join(" ")}};e.writeRtcpFb=function(a){var b="",d=a.payloadType;void 0!==a.preferredPayloadType&&(d=a.preferredPayloadType);a.rtcpFeedback&&
a.rtcpFeedback.length&&a.rtcpFeedback.forEach(function(a){b+="a=rtcp-fb:"+d+" "+a.type+(a.parameter&&a.parameter.length?" "+a.parameter:"")+"\r\n"});return b};e.parseSsrcMedia=function(a){var b=a.indexOf(" "),d={ssrc:parseInt(a.substr(7,b-7),10)},c=a.indexOf(":",b);-1<c?(d.attribute=a.substr(b+1,c-b-1),d.value=a.substr(c+1)):d.attribute=a.substr(b+1);return d};e.parseSsrcGroup=function(a){a=a.substr(13).split(" ");return{semantics:a.shift(),ssrcs:a.map(function(a){return parseInt(a,10)})}};e.getMid=
function(a){if(a=e.matchPrefix(a,"a=mid:")[0])return a.substr(6)};e.parseFingerprint=function(a){a=a.substr(14).split(" ");return{algorithm:a[0].toLowerCase(),value:a[1]}};e.getDtlsParameters=function(a,b){return{role:"auto",fingerprints:e.matchPrefix(a+b,"a=fingerprint:").map(e.parseFingerprint)}};e.writeDtlsParameters=function(a,b){var d="a=setup:"+b+"\r\n";a.fingerprints.forEach(function(a){d+="a=fingerprint:"+a.algorithm+" "+a.value+"\r\n"});return d};e.getIceParameters=function(a,b){a=e.splitLines(a);
a=a.concat(e.splitLines(b));return{usernameFragment:a.filter(function(a){return 0===a.indexOf("a=ice-ufrag:")})[0].substr(12),password:a.filter(function(a){return 0===a.indexOf("a=ice-pwd:")})[0].substr(10)}};e.writeIceParameters=function(a){return"a=ice-ufrag:"+a.usernameFragment+"\r\na=ice-pwd:"+a.password+"\r\n"};e.parseRtpParameters=function(a){for(var b={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},d=e.splitLines(a)[0].split(" "),c=3;c<d.length;c++){var k=d[c],l=e.matchPrefix(a,"a=rtpmap:"+
k+" ")[0];if(l){l=e.parseRtpMap(l);var g=e.matchPrefix(a,"a=fmtp:"+k+" ");l.parameters=g.length?e.parseFmtp(g[0]):{};l.rtcpFeedback=e.matchPrefix(a,"a=rtcp-fb:"+k+" ").map(e.parseRtcpFb);b.codecs.push(l);switch(l.name.toUpperCase()){case "RED":case "ULPFEC":b.fecMechanisms.push(l.name.toUpperCase())}}}e.matchPrefix(a,"a=extmap:").forEach(function(a){b.headerExtensions.push(e.parseExtmap(a))});return b};e.writeRtpDescription=function(a,b){var d="";d+="m="+a+" ";d+=0<b.codecs.length?"9":"0";d+=" UDP/TLS/RTP/SAVPF ";
d+=b.codecs.map(function(a){return void 0!==a.preferredPayloadType?a.preferredPayloadType:a.payloadType}).join(" ")+"\r\n";d+="c=IN IP4 0.0.0.0\r\n";d+="a=rtcp:9 IN IP4 0.0.0.0\r\n";b.codecs.forEach(function(a){d+=e.writeRtpMap(a);d+=e.writeFmtp(a);d+=e.writeRtcpFb(a)});var c=0;b.codecs.forEach(function(a){a.maxptime>c&&(c=a.maxptime)});0<c&&(d+="a=maxptime:"+c+"\r\n");d+="a=rtcp-mux\r\n";b.headerExtensions&&b.headerExtensions.forEach(function(a){d+=e.writeExtmap(a)});return d};e.parseRtpEncodingParameters=
function(a){var b=[],d=e.parseRtpParameters(a),c=-1!==d.fecMechanisms.indexOf("RED"),k=-1!==d.fecMechanisms.indexOf("ULPFEC"),l=e.matchPrefix(a,"a=ssrc:").map(function(a){return e.parseSsrcMedia(a)}).filter(function(a){return"cname"===a.attribute}),g=0<l.length&&l[0].ssrc,n;l=e.matchPrefix(a,"a=ssrc-group:FID").map(function(a){return a.substr(17).split(" ").map(function(a){return parseInt(a,10)})});0<l.length&&1<l[0].length&&l[0][0]===g&&(n=l[0][1]);d.codecs.forEach(function(a){"RTX"===a.name.toUpperCase()&&
a.parameters.apt&&(a={ssrc:g,codecPayloadType:parseInt(a.parameters.apt,10)},g&&n&&(a.rtx={ssrc:n}),b.push(a),c&&(a=JSON.parse(JSON.stringify(a)),a.fec={ssrc:g,mechanism:k?"red+ulpfec":"red"},b.push(a)))});0===b.length&&g&&b.push({ssrc:g});var f=e.matchPrefix(a,"b=");f.length&&(f=0===f[0].indexOf("b=TIAS:")?parseInt(f[0].substr(7),10):0===f[0].indexOf("b=AS:")?950*parseInt(f[0].substr(5),10)-16E3:void 0,b.forEach(function(a){a.maxBitrate=f}));return b};e.parseRtcpParameters=function(a){var b={},d=
e.matchPrefix(a,"a=ssrc:").map(function(a){return e.parseSsrcMedia(a)}).filter(function(a){return"cname"===a.attribute})[0];d&&(b.cname=d.value,b.ssrc=d.ssrc);d=e.matchPrefix(a,"a=rtcp-rsize");b.reducedSize=0<d.length;b.compound=0===d.length;a=e.matchPrefix(a,"a=rtcp-mux");b.mux=0<a.length;return b};e.parseMsid=function(a){var b=e.matchPrefix(a,"a=msid:");if(1===b.length)return a=b[0].substr(7).split(" "),{stream:a[0],track:a[1]};a=e.matchPrefix(a,"a=ssrc:").map(function(a){return e.parseSsrcMedia(a)}).filter(function(a){return"msid"===
a.attribute});if(0<a.length)return a=a[0].value.split(" "),{stream:a[0],track:a[1]}};e.generateSessionId=function(){return Math.random().toString().substr(2,21)};e.writeSessionBoilerplate=function(a,b,d){b=void 0!==b?b:2;a=a?a:e.generateSessionId();return"v=0\r\no="+(d||"thisisadapterortc")+" "+a+" "+b+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"};e.writeMediaSection=function(a,b,d,c){b=e.writeRtpDescription(a.kind,b);b+=e.writeIceParameters(a.iceGatherer.getLocalParameters());b+=e.writeDtlsParameters(a.dtlsTransport.getLocalParameters(),
"offer"===d?"actpass":"active");b+="a=mid:"+a.mid+"\r\n";b=a.direction?b+("a="+a.direction+"\r\n"):a.rtpSender&&a.rtpReceiver?b+"a=sendrecv\r\n":a.rtpSender?b+"a=sendonly\r\n":a.rtpReceiver?b+"a=recvonly\r\n":b+"a=inactive\r\n";a.rtpSender&&(d="msid:"+c.id+" "+a.rtpSender.track.id+"\r\n",b=b+("a="+d)+("a=ssrc:"+a.sendEncodingParameters[0].ssrc+" "+d),a.sendEncodingParameters[0].rtx&&(b+="a=ssrc:"+a.sendEncodingParameters[0].rtx.ssrc+" "+d,b+="a=ssrc-group:FID "+a.sendEncodingParameters[0].ssrc+" "+
a.sendEncodingParameters[0].rtx.ssrc+"\r\n"));b+="a=ssrc:"+a.sendEncodingParameters[0].ssrc+" cname:"+e.localCName+"\r\n";a.rtpSender&&a.sendEncodingParameters[0].rtx&&(b+="a=ssrc:"+a.sendEncodingParameters[0].rtx.ssrc+" cname:"+e.localCName+"\r\n");return b};e.getDirection=function(a,b){a=e.splitLines(a);for(var d=0;d<a.length;d++)switch(a[d]){case "a=sendrecv":case "a=sendonly":case "a=recvonly":case "a=inactive":return a[d].substr(2)}return b?e.getDirection(b):"sendrecv"};e.getKind=function(a){return e.splitLines(a)[0].split(" ")[0].substr(2)};
e.isRejected=function(a){return"0"===a.split(" ",2)[1]};e.parseMLine=function(a){a=e.splitLines(a)[0].substr(2).split(" ");return{kind:a[0],port:parseInt(a[1],10),protocol:a[2],fmt:a.slice(3).join(" ")}};e.parseOLine=function(a){a=e.matchPrefix(a,"o=")[0].substr(2).split(" ");return{username:a[0],sessionId:a[1],sessionVersion:parseInt(a[2],10),netType:a[3],addressType:a[4],address:a[5]}};e.isValidSDP=function(a){if("string"!==typeof a||0===a.length)return!1;a=e.splitLines(a);for(var b=0;b<a.length;b++)if(2>
a[b].length||"="!==a[b].charAt(1))return!1;return!0};"object"===typeof p&&(p.exports=e)},{}],3:[function(m,p,q){q="undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{};m=m("./adapter_factory.js");p.exports=m({window:q.window})},{"./adapter_factory.js":4}],4:[function(m,p,q){var e=m("./utils");p.exports=function(a,b){a=a&&a.window;var d={shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0};for(c in b)hasOwnProperty.call(b,c)&&(d[c]=b[c]);b=e.log;
var c=e.detectBrowser(a);var k=m("./chrome/chrome_shim")||null,l=m("./edge/edge_shim")||null,g=m("./firefox/firefox_shim")||null,n=m("./safari/safari_shim")||null,f=m("./common_shim")||null,h={browserDetails:c,commonShim:f,extractVersion:e.extractVersion,disableLog:e.disableLog,disableWarnings:e.disableWarnings};switch(c.browser){case "chrome":if(!k||!k.shimPeerConnection||!d.shimChrome){b("Chrome shim is not included in this adapter release.");break}b("adapter.js shimming chrome.");h.browserShim=
k;f.shimCreateObjectURL(a);k.shimGetUserMedia(a);k.shimMediaStream(a);k.shimSourceObject(a);k.shimPeerConnection(a);k.shimOnTrack(a);k.shimAddTrackRemoveTrack(a);k.shimGetSendersWithDtmf(a);k.shimSenderReceiverGetStats(a);k.fixNegotiationNeeded(a);f.shimRTCIceCandidate(a);f.shimMaxMessageSize(a);f.shimSendThrowTypeError(a);break;case "firefox":if(!g||!g.shimPeerConnection||!d.shimFirefox){b("Firefox shim is not included in this adapter release.");break}b("adapter.js shimming firefox.");h.browserShim=
g;f.shimCreateObjectURL(a);g.shimGetUserMedia(a);g.shimSourceObject(a);g.shimPeerConnection(a);g.shimOnTrack(a);g.shimRemoveStream(a);g.shimSenderGetStats(a);g.shimReceiverGetStats(a);g.shimRTCDataChannel(a);f.shimRTCIceCandidate(a);f.shimMaxMessageSize(a);f.shimSendThrowTypeError(a);break;case "edge":if(!l||!l.shimPeerConnection||!d.shimEdge){b("MS edge shim is not included in this adapter release.");break}b("adapter.js shimming edge.");h.browserShim=l;f.shimCreateObjectURL(a);l.shimGetUserMedia(a);
l.shimPeerConnection(a);l.shimReplaceTrack(a);f.shimMaxMessageSize(a);f.shimSendThrowTypeError(a);break;case "safari":if(!n||!d.shimSafari){b("Safari shim is not included in this adapter release.");break}b("adapter.js shimming safari.");h.browserShim=n;f.shimCreateObjectURL(a);n.shimRTCIceServerUrls(a);n.shimCreateOfferLegacy(a);n.shimCallbacksAPI(a);n.shimLocalStreamsAPI(a);n.shimRemoteStreamsAPI(a);n.shimTrackEventTransceiver(a);n.shimGetUserMedia(a);f.shimRTCIceCandidate(a);f.shimMaxMessageSize(a);
f.shimSendThrowTypeError(a);break;default:b("Unsupported browser!")}return h}},{"./chrome/chrome_shim":5,"./common_shim":7,"./edge/edge_shim":1,"./firefox/firefox_shim":8,"./safari/safari_shim":10,"./utils":11}],5:[function(m,p,q){function e(a,b,d){b&&!d.has(b.id)&&(d.set(b.id,b),Object.keys(b).forEach(function(c){c.endsWith("Id")?e(a,a.get(b[c]),d):c.endsWith("Ids")&&b[c].forEach(function(c){e(a,a.get(c),d)})}))}function a(a,b,d){var c=d?"outbound-rtp":"inbound-rtp",k=new Map;if(null===b)return k;
var f=[];a.forEach(function(a){"track"===a.type&&a.trackIdentifier===b.id&&f.push(a)});f.forEach(function(b){a.forEach(function(d){d.type===c&&d.trackId===b.id&&e(a,d,k)})});return k}var b=m("../utils.js"),d=b.log;p.exports={shimGetUserMedia:m("./getusermedia"),shimMediaStream:function(a){a.MediaStream=a.MediaStream||a.webkitMediaStream},shimOnTrack:function(a){if("object"!==typeof a||!a.RTCPeerConnection||"ontrack"in a.RTCPeerConnection.prototype)b.wrapPeerConnectionEvent(a,"track",function(a){a.transceiver||
Object.defineProperty(a,"transceiver",{value:{receiver:a.receiver}});return a});else{Object.defineProperty(a.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(a){this._ontrack&&this.removeEventListener("track",this._ontrack);this.addEventListener("track",this._ontrack=a)},enumerable:!0,configurable:!0});var c=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(){var b=this;b._ontrackpoly||(b._ontrackpoly=
function(c){c.stream.addEventListener("addtrack",function(d){var f=a.RTCPeerConnection.prototype.getReceivers?b.getReceivers().find(function(a){return a.track&&a.track.id===d.track.id}):{track:d.track};var h=new Event("track");h.track=d.track;h.receiver=f;h.transceiver={receiver:f};h.streams=[c.stream];b.dispatchEvent(h)});c.stream.getTracks().forEach(function(d){var f=a.RTCPeerConnection.prototype.getReceivers?b.getReceivers().find(function(a){return a.track&&a.track.id===d.id}):{track:d};var h=
new Event("track");h.track=d;h.receiver=f;h.transceiver={receiver:f};h.streams=[c.stream];b.dispatchEvent(h)})},b.addEventListener("addstream",b._ontrackpoly));return c.apply(b,arguments)}}},shimGetSendersWithDtmf:function(a){if("object"===typeof a&&a.RTCPeerConnection&&!("getSenders"in a.RTCPeerConnection.prototype)&&"createDTMFSender"in a.RTCPeerConnection.prototype){var c=function(a,c){return{track:c,get dtmf(){void 0===this._dtmf&&(this._dtmf="audio"===c.kind?a.createDTMFSender(c):null);return this._dtmf},
_pc:a}};if(!a.RTCPeerConnection.prototype.getSenders){a.RTCPeerConnection.prototype.getSenders=function(){this._senders=this._senders||[];return this._senders.slice()};var b=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addTrack=function(a,d){var h=b.apply(this,arguments);h||(h=c(this,a),this._senders.push(h));return h};var d=a.RTCPeerConnection.prototype.removeTrack;a.RTCPeerConnection.prototype.removeTrack=function(a){d.apply(this,arguments);var c=this._senders.indexOf(a);
-1!==c&&this._senders.splice(c,1)}}var e=a.RTCPeerConnection.prototype.addStream;a.RTCPeerConnection.prototype.addStream=function(a){var b=this;b._senders=b._senders||[];e.apply(b,[a]);a.getTracks().forEach(function(a){b._senders.push(c(b,a))})};var f=a.RTCPeerConnection.prototype.removeStream;a.RTCPeerConnection.prototype.removeStream=function(a){var c=this;c._senders=c._senders||[];f.apply(c,[a]);a.getTracks().forEach(function(a){var b=c._senders.find(function(c){return c.track===a});b&&c._senders.splice(c._senders.indexOf(b),
1)})}}else if("object"===typeof a&&a.RTCPeerConnection&&"getSenders"in a.RTCPeerConnection.prototype&&"createDTMFSender"in a.RTCPeerConnection.prototype&&a.RTCRtpSender&&!("dtmf"in a.RTCRtpSender.prototype)){var h=a.RTCPeerConnection.prototype.getSenders;a.RTCPeerConnection.prototype.getSenders=function(){var a=this,c=h.apply(a,[]);c.forEach(function(c){c._pc=a});return c};Object.defineProperty(a.RTCRtpSender.prototype,"dtmf",{get:function(){void 0===this._dtmf&&(this._dtmf="audio"===this.track.kind?
this._pc.createDTMFSender(this.track):null);return this._dtmf}})}},shimSenderReceiverGetStats:function(c){if("object"===typeof c&&c.RTCPeerConnection&&c.RTCRtpSender&&c.RTCRtpReceiver){if(!("getStats"in c.RTCRtpSender.prototype)){var d=c.RTCPeerConnection.prototype.getSenders;d&&(c.RTCPeerConnection.prototype.getSenders=function(){var a=this,c=d.apply(a,[]);c.forEach(function(c){c._pc=a});return c});var e=c.RTCPeerConnection.prototype.addTrack;e&&(c.RTCPeerConnection.prototype.addTrack=function(){var a=
e.apply(this,arguments);a._pc=this;return a});c.RTCRtpSender.prototype.getStats=function(){var c=this;return this._pc.getStats().then(function(b){return a(b,c.track,!0)})}}if(!("getStats"in c.RTCRtpReceiver.prototype)){var g=c.RTCPeerConnection.prototype.getReceivers;g&&(c.RTCPeerConnection.prototype.getReceivers=function(){var a=this,c=g.apply(a,[]);c.forEach(function(c){c._pc=a});return c});b.wrapPeerConnectionEvent(c,"track",function(a){a.receiver._pc=a.srcElement;return a});c.RTCRtpReceiver.prototype.getStats=
function(){var c=this;return this._pc.getStats().then(function(b){return a(b,c.track,!1)})}}if("getStats"in c.RTCRtpSender.prototype&&"getStats"in c.RTCRtpReceiver.prototype){var n=c.RTCPeerConnection.prototype.getStats;c.RTCPeerConnection.prototype.getStats=function(){if(0<arguments.length&&arguments[0]instanceof c.MediaStreamTrack){var a=arguments[0],b,d,k;this.getSenders().forEach(function(c){c.track===a&&(b?k=!0:b=c)});this.getReceivers().forEach(function(c){c.track===a&&(d?k=!0:d=c);return c.track===
a});return k||b&&d?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):b?b.getStats():d?d.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return n.apply(this,arguments)}}}},shimSourceObject:function(a){var c=a&&a.URL;"object"===typeof a&&(!a.HTMLMediaElement||"srcObject"in a.HTMLMediaElement.prototype||Object.defineProperty(a.HTMLMediaElement.prototype,"srcObject",{get:function(){return this._srcObject},
set:function(a){var b=this;this._srcObject=a;this.src&&c.revokeObjectURL(this.src);a?(this.src=c.createObjectURL(a),a.addEventListener("addtrack",function(){b.src&&c.revokeObjectURL(b.src);b.src=c.createObjectURL(a)}),a.addEventListener("removetrack",function(){b.src&&c.revokeObjectURL(b.src);b.src=c.createObjectURL(a)})):this.src=""}}))},shimAddTrackRemoveTrackWithNative:function(a){a.RTCPeerConnection.prototype.getLocalStreams=function(){var a=this;this._shimmedLocalStreams=this._shimmedLocalStreams||
{};return Object.keys(this._shimmedLocalStreams).map(function(c){return a._shimmedLocalStreams[c][0]})};var c=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addTrack=function(a,b){if(!b)return c.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var d=c.apply(this,arguments);this._shimmedLocalStreams[b.id]?-1===this._shimmedLocalStreams[b.id].indexOf(d)&&this._shimmedLocalStreams[b.id].push(d):this._shimmedLocalStreams[b.id]=[b,d];return d};var b=a.RTCPeerConnection.prototype.addStream;
a.RTCPeerConnection.prototype.addStream=function(a){var c=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{};a.getTracks().forEach(function(a){if(c.getSenders().find(function(c){return c.track===a}))throw new DOMException("Track already exists.","InvalidAccessError");});var d=c.getSenders();b.apply(this,arguments);var e=c.getSenders().filter(function(a){return-1===d.indexOf(a)});this._shimmedLocalStreams[a.id]=[a].concat(e)};var d=a.RTCPeerConnection.prototype.removeStream;a.RTCPeerConnection.prototype.removeStream=
function(a){this._shimmedLocalStreams=this._shimmedLocalStreams||{};delete this._shimmedLocalStreams[a.id];return d.apply(this,arguments)};var e=a.RTCPeerConnection.prototype.removeTrack;a.RTCPeerConnection.prototype.removeTrack=function(a){var c=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{};a&&Object.keys(this._shimmedLocalStreams).forEach(function(b){var d=c._shimmedLocalStreams[b].indexOf(a);-1!==d&&c._shimmedLocalStreams[b].splice(d,1);1===c._shimmedLocalStreams[b].length&&delete c._shimmedLocalStreams[b]});
return e.apply(this,arguments)}},shimAddTrackRemoveTrack:function(a){function c(a,c){var b=c.sdp;Object.keys(a._reverseStreams||[]).forEach(function(c){c=a._reverseStreams[c];b=b.replace(new RegExp(a._streams[c.id].id,"g"),c.id)});return new RTCSessionDescription({type:c.type,sdp:b})}function d(a,c){var b=c.sdp;Object.keys(a._reverseStreams||[]).forEach(function(c){c=a._reverseStreams[c];b=b.replace(new RegExp(c.id,"g"),a._streams[c.id].id)});return new RTCSessionDescription({type:c.type,sdp:b})}
var e=b.detectBrowser(a);if(a.RTCPeerConnection.prototype.addTrack&&65<=e.version)return this.shimAddTrackRemoveTrackWithNative(a);var n=a.RTCPeerConnection.prototype.getLocalStreams;a.RTCPeerConnection.prototype.getLocalStreams=function(){var a=this,c=n.apply(this);a._reverseStreams=a._reverseStreams||{};return c.map(function(c){return a._reverseStreams[c.id]})};var f=a.RTCPeerConnection.prototype.addStream;a.RTCPeerConnection.prototype.addStream=function(c){var b=this;b._streams=b._streams||{};
b._reverseStreams=b._reverseStreams||{};c.getTracks().forEach(function(a){if(b.getSenders().find(function(c){return c.track===a}))throw new DOMException("Track already exists.","InvalidAccessError");});if(!b._reverseStreams[c.id]){var d=new a.MediaStream(c.getTracks());b._streams[c.id]=d;b._reverseStreams[d.id]=c;c=d}f.apply(b,[c])};var h=a.RTCPeerConnection.prototype.removeStream;a.RTCPeerConnection.prototype.removeStream=function(a){this._streams=this._streams||{};this._reverseStreams=this._reverseStreams||
{};h.apply(this,[this._streams[a.id]||a]);delete this._reverseStreams[this._streams[a.id]?this._streams[a.id].id:a.id];delete this._streams[a.id]};a.RTCPeerConnection.prototype.addTrack=function(c,b){var d=this;if("closed"===d.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var h=[].slice.call(arguments,1);if(1!==h.length||!h[0].getTracks().find(function(a){return a===c}))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.",
"NotSupportedError");if(d.getSenders().find(function(a){return a.track===c}))throw new DOMException("Track already exists.","InvalidAccessError");d._streams=d._streams||{};d._reverseStreams=d._reverseStreams||{};(h=d._streams[b.id])?(h.addTrack(c),Promise.resolve().then(function(){d.dispatchEvent(new Event("negotiationneeded"))})):(h=new a.MediaStream([c]),d._streams[b.id]=h,d._reverseStreams[h.id]=b,d.addStream(h));return d.getSenders().find(function(a){return a.track===c})};["createOffer","createAnswer"].forEach(function(b){var d=
a.RTCPeerConnection.prototype[b];a.RTCPeerConnection.prototype[b]=function(){var a=this,b=arguments;return arguments.length&&"function"===typeof arguments[0]?d.apply(a,[function(d){d=c(a,d);b[0].apply(null,[d])},function(a){b[1]&&b[1].apply(null,a)},arguments[2]]):d.apply(a,arguments).then(function(b){return c(a,b)})}});var r=a.RTCPeerConnection.prototype.setLocalDescription;a.RTCPeerConnection.prototype.setLocalDescription=function(){if(!arguments.length||!arguments[0].type)return r.apply(this,arguments);
arguments[0]=d(this,arguments[0]);return r.apply(this,arguments)};var t=Object.getOwnPropertyDescriptor(a.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(a.RTCPeerConnection.prototype,"localDescription",{get:function(){var a=t.get.apply(this);return""===a.type?a:c(this,a)}});a.RTCPeerConnection.prototype.removeTrack=function(a){var c=this;if("closed"===c.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!a._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.",
"TypeError");if(a._pc!==c)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");c._streams=c._streams||{};var b;Object.keys(c._streams).forEach(function(d){c._streams[d].getTracks().find(function(c){return a.track===c})&&(b=c._streams[d])});b&&(1===b.getTracks().length?c.removeStream(c._reverseStreams[b.id]):b.removeTrack(a.track),c.dispatchEvent(new Event("negotiationneeded")))}},shimPeerConnection:function(a){var c=b.detectBrowser(a);!a.RTCPeerConnection&&a.webkitRTCPeerConnection&&
(a.RTCPeerConnection=function(c,b){d("PeerConnection");c&&c.iceTransportPolicy&&(c.iceTransports=c.iceTransportPolicy);return new a.webkitRTCPeerConnection(c,b)},a.RTCPeerConnection.prototype=a.webkitRTCPeerConnection.prototype,a.webkitRTCPeerConnection.generateCertificate&&Object.defineProperty(a.RTCPeerConnection,"generateCertificate",{get:function(){return a.webkitRTCPeerConnection.generateCertificate}}));var e=a.RTCPeerConnection.prototype.getStats;a.RTCPeerConnection.prototype.getStats=function(a,
c,b){var d=this,h=arguments;if(0<arguments.length&&"function"===typeof a)return e.apply(this,arguments);if(0===e.length&&(0===arguments.length||"function"!==typeof arguments[0]))return e.apply(this,[]);var k=function(a){var c={};a.result().forEach(function(a){var b={id:a.id,timestamp:a.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[a.type]||a.type};a.names().forEach(function(c){b[c]=a.stat(c)});c[b.id]=b});return c},f=function(a){return new Map(Object.keys(a).map(function(c){return[c,
a[c]]}))};return 2<=arguments.length?e.apply(this,[function(a){h[1](f(k(a)))},arguments[0]]):(new Promise(function(a,c){e.apply(d,[function(c){a(f(k(c)))},c])})).then(c,b)};51>c.version&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(c){var b=a.RTCPeerConnection.prototype[c];a.RTCPeerConnection.prototype[c]=function(){var a=arguments,c=this,d=new Promise(function(d,h){b.apply(c,[a[0],d,h])});return 2>a.length?d:d.then(function(){a[1].apply(null,[])},function(c){3<=
a.length&&a[2].apply(null,[c])})}});52>c.version&&["createOffer","createAnswer"].forEach(function(c){var b=a.RTCPeerConnection.prototype[c];a.RTCPeerConnection.prototype[c]=function(){var a=this;if(1>arguments.length||1===arguments.length&&"object"===typeof arguments[0]){var c=1===arguments.length?arguments[0]:void 0;return new Promise(function(d,h){b.apply(a,[d,h,c])})}return b.apply(this,arguments)}});["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(c){var b=a.RTCPeerConnection.prototype[c];
a.RTCPeerConnection.prototype[c]=function(){arguments[0]=new ("addIceCandidate"===c?a.RTCIceCandidate:a.RTCSessionDescription)(arguments[0]);return b.apply(this,arguments)}});var g=a.RTCPeerConnection.prototype.addIceCandidate;a.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?g.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}},fixNegotiationNeeded:function(a){b.wrapPeerConnectionEvent(a,"negotiationneeded",function(a){if("stable"===a.target.signalingState)return a})},
shimGetDisplayMedia:function(a,b){"getDisplayMedia"in a.navigator||("function"!==typeof b?console.error("shimGetDisplayMedia: getSourceId argument is not a function"):navigator.getDisplayMedia=function(a){return b(a).then(function(c){a.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:c,maxFrameRate:a.video.frameRate||3}};return navigator.mediaDevices.getUserMedia(a)})})}}},{"../utils.js":11,"./getusermedia":6}],6:[function(m,p,q){var e=m("../utils.js"),a=e.log;p.exports=function(b){var d=
e.detectBrowser(b),c=b&&b.navigator,k=function(a){if("object"!==typeof a||a.mandatory||a.optional)return a;var c={};Object.keys(a).forEach(function(b){if("require"!==b&&"advanced"!==b&&"mediaSource"!==b){var d="object"===typeof a[b]?a[b]:{ideal:a[b]};void 0!==d.exact&&"number"===typeof d.exact&&(d.min=d.max=d.exact);var h=function(a,c){return a?a+c.charAt(0).toUpperCase()+c.slice(1):"deviceId"===c?"sourceId":c};if(void 0!==d.ideal){c.optional=c.optional||[];var e={};"number"===typeof d.ideal?(e[h("min",
b)]=d.ideal,c.optional.push(e),e={},e[h("max",b)]=d.ideal):e[h("",b)]=d.ideal;c.optional.push(e)}void 0!==d.exact&&"number"!==typeof d.exact?(c.mandatory=c.mandatory||{},c.mandatory[h("",b)]=d.exact):["min","max"].forEach(function(a){void 0!==d[a]&&(c.mandatory=c.mandatory||{},c.mandatory[h(a,b)]=d[a])})}});a.advanced&&(c.optional=(c.optional||[]).concat(a.advanced));return c},l=function(b,e){if(61<=d.version)return e(b);if((b=JSON.parse(JSON.stringify(b)))&&"object"===typeof b.audio){var h=function(a,
c,b){c in a&&!(b in a)&&(a[b]=a[c],delete a[c])};b=JSON.parse(JSON.stringify(b));h(b.audio,"autoGainControl","googAutoGainControl");h(b.audio,"noiseSuppression","googNoiseSuppression");b.audio=k(b.audio)}if(b&&"object"===typeof b.video){var f=b.video.facingMode;f=f&&("object"===typeof f?f:{ideal:f});h=66>d.version;if(!(!f||"user"!==f.exact&&"environment"!==f.exact&&"user"!==f.ideal&&"environment"!==f.ideal||c.mediaDevices.getSupportedConstraints&&c.mediaDevices.getSupportedConstraints().facingMode&&
!h)){delete b.video.facingMode;if("environment"===f.exact||"environment"===f.ideal)var g=["back","rear"];else if("user"===f.exact||"user"===f.ideal)g=["front"];if(g)return c.mediaDevices.enumerateDevices().then(function(c){c=c.filter(function(a){return"videoinput"===a.kind});var d=c.find(function(a){return g.some(function(c){return-1!==a.label.toLowerCase().indexOf(c)})});!d&&c.length&&-1!==g.indexOf("back")&&(d=c[c.length-1]);d&&(b.video.deviceId=f.exact?{exact:d.deviceId}:{ideal:d.deviceId});b.video=
k(b.video);a("chrome: "+JSON.stringify(b));return e(b)})}b.video=k(b.video)}a("chrome: "+JSON.stringify(b));return e(b)},g=function(a){return 64<=d.version?a:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",
ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[a.name]||a.name,message:a.message,constraint:a.constraint||a.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};c.getUserMedia=function(a,b,d){l(a,function(a){c.webkitGetUserMedia(a,b,function(a){d&&d(g(a))})})};var n=function(a){return new Promise(function(b,d){c.getUserMedia(a,b,d)})};c.mediaDevices||(c.mediaDevices={getUserMedia:n,enumerateDevices:function(){return new Promise(function(a){var c=
{audio:"audioinput",video:"videoinput"};return b.MediaStreamTrack.getSources(function(b){a(b.map(function(a){return{label:a.label,kind:c[a.kind],deviceId:a.id,groupId:""}}))})})},getSupportedConstraints:function(){return{deviceId:!0,echoCancellation:!0,facingMode:!0,frameRate:!0,height:!0,width:!0}}});if(c.mediaDevices.getUserMedia){var f=c.mediaDevices.getUserMedia.bind(c.mediaDevices);c.mediaDevices.getUserMedia=function(a){return l(a,function(a){return f(a).then(function(c){if(a.audio&&!c.getAudioTracks().length||
a.video&&!c.getVideoTracks().length)throw c.getTracks().forEach(function(a){a.stop()}),new DOMException("","NotFoundError");return c},function(a){return Promise.reject(g(a))})})}}else c.mediaDevices.getUserMedia=function(a){return n(a)};"undefined"===typeof c.mediaDevices.addEventListener&&(c.mediaDevices.addEventListener=function(){a("Dummy mediaDevices.addEventListener called.")});"undefined"===typeof c.mediaDevices.removeEventListener&&(c.mediaDevices.removeEventListener=function(){a("Dummy mediaDevices.removeEventListener called.")})}},
{"../utils.js":11}],7:[function(m,p,q){var e=m("sdp"),a=m("./utils");p.exports={shimRTCIceCandidate:function(b){if(b.RTCIceCandidate&&!(b.RTCIceCandidate&&"foundation"in b.RTCIceCandidate.prototype)){var d=b.RTCIceCandidate;b.RTCIceCandidate=function(a){"object"===typeof a&&a.candidate&&0===a.candidate.indexOf("a=")&&(a=JSON.parse(JSON.stringify(a)),a.candidate=a.candidate.substr(2));if(a.candidate&&a.candidate.length){var b=new d(a);a=e.parseCandidate(a.candidate);var c=Object.assign(b,a);c.toJSON=
function(){return{candidate:c.candidate,sdpMid:c.sdpMid,sdpMLineIndex:c.sdpMLineIndex,usernameFragment:c.usernameFragment}};return c}return new d(a)};b.RTCIceCandidate.prototype=d.prototype;a.wrapPeerConnectionEvent(b,"icecandidate",function(a){a.candidate&&Object.defineProperty(a,"candidate",{value:new b.RTCIceCandidate(a.candidate),writable:"false"});return a})}},shimCreateObjectURL:function(b){var d=b&&b.URL;if("object"===typeof b&&b.HTMLMediaElement&&"srcObject"in b.HTMLMediaElement.prototype&&
d.createObjectURL&&d.revokeObjectURL){var c=d.createObjectURL.bind(d),e=d.revokeObjectURL.bind(d),l=new Map,g=0;d.createObjectURL=function(b){if("getTracks"in b){var d="polyblob:"+ ++g;l.set(d,b);a.deprecated("URL.createObjectURL(stream)","elem.srcObject = stream");return d}return c(b)};d.revokeObjectURL=function(a){e(a);l.delete(a)};var n=Object.getOwnPropertyDescriptor(b.HTMLMediaElement.prototype,"src");Object.defineProperty(b.HTMLMediaElement.prototype,"src",{get:function(){return n.get.apply(this)},
set:function(a){this.srcObject=l.get(a)||null;return n.set.apply(this,[a])}});var f=b.HTMLMediaElement.prototype.setAttribute;b.HTMLMediaElement.prototype.setAttribute=function(){2===arguments.length&&"src"===(""+arguments[0]).toLowerCase()&&(this.srcObject=l.get(arguments[1])||null);return f.apply(this,arguments)}}},shimMaxMessageSize:function(b){if(!b.RTCSctpTransport&&b.RTCPeerConnection){var d=a.detectBrowser(b);"sctp"in b.RTCPeerConnection.prototype||Object.defineProperty(b.RTCPeerConnection.prototype,
"sctp",{get:function(){return"undefined"===typeof this._sctp?null:this._sctp}});var c=function(a){a=e.splitSections(a.sdp);a.shift();return a.some(function(a){return(a=e.parseMLine(a))&&"application"===a.kind&&-1!==a.protocol.indexOf("SCTP")})},k=function(a){a=a.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===a||2>a.length)return-1;a=parseInt(a[1],10);return a!==a?-1:a},l=function(a){var b=65536;"firefox"===d.browser&&(b=57>d.version?-1===a?16384:2147483637:60>d.version?57===d.version?65535:
65536:2147483637);return b},g=function(a,b){var c=65536;"firefox"===d.browser&&57===d.version&&(c=65535);a=e.matchPrefix(a.sdp,"a=max-message-size:");0<a.length?c=parseInt(a[0].substr(19),10):"firefox"===d.browser&&-1!==b&&(c=2147483637);return c},n=b.RTCPeerConnection.prototype.setRemoteDescription;b.RTCPeerConnection.prototype.setRemoteDescription=function(){this._sctp=null;if(c(arguments[0])){var a=k(arguments[0]),b=l(a);a=g(arguments[0],a);var d=0===b&&0===a?Number.POSITIVE_INFINITY:0===b||0===
a?Math.max(b,a):Math.min(b,a);b={};Object.defineProperty(b,"maxMessageSize",{get:function(){return d}});this._sctp=b}return n.apply(this,arguments)}}},shimSendThrowTypeError:function(b){function d(a,b){var c=a.send;a.send=function(){var d=arguments[0];d=d.length||d.size||d.byteLength;if("open"===a.readyState&&b.sctp&&d>b.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+b.sctp.maxMessageSize+" bytes)");return c.apply(a,arguments)}}if(b.RTCPeerConnection&&"createDataChannel"in
b.RTCPeerConnection.prototype){var c=b.RTCPeerConnection.prototype.createDataChannel;b.RTCPeerConnection.prototype.createDataChannel=function(){var a=c.apply(this,arguments);d(a,this);return a};a.wrapPeerConnectionEvent(b,"datachannel",function(a){d(a.channel,a.target);return a})}}}},{"./utils":11,sdp:2}],8:[function(m,p,q){var e=m("../utils");p.exports={shimGetUserMedia:m("./getusermedia"),shimOnTrack:function(a){"object"!==typeof a||!a.RTCPeerConnection||"ontrack"in a.RTCPeerConnection.prototype||
Object.defineProperty(a.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(a){this._ontrack&&(this.removeEventListener("track",this._ontrack),this.removeEventListener("addstream",this._ontrackpoly));this.addEventListener("track",this._ontrack=a);this.addEventListener("addstream",this._ontrackpoly=function(a){a.stream.getTracks().forEach(function(b){var c=new Event("track");c.track=b;c.receiver={track:b};c.transceiver={receiver:c.receiver};c.streams=[a.stream];
this.dispatchEvent(c)}.bind(this))}.bind(this))},enumerable:!0,configurable:!0});"object"===typeof a&&a.RTCTrackEvent&&"receiver"in a.RTCTrackEvent.prototype&&!("transceiver"in a.RTCTrackEvent.prototype)&&Object.defineProperty(a.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},shimSourceObject:function(a){"object"===typeof a&&(!a.HTMLMediaElement||"srcObject"in a.HTMLMediaElement.prototype||Object.defineProperty(a.HTMLMediaElement.prototype,"srcObject",{get:function(){return this.mozSrcObject},
set:function(a){this.mozSrcObject=a}}))},shimPeerConnection:function(a){var b=e.detectBrowser(a);if("object"===typeof a&&(a.RTCPeerConnection||a.mozRTCPeerConnection)){a.RTCPeerConnection||(a.RTCPeerConnection=function(c,d){if(38>b.version&&c&&c.iceServers){for(var e=[],k=0;k<c.iceServers.length;k++){var g=c.iceServers[k];if(g.hasOwnProperty("urls"))for(var n=0;n<g.urls.length;n++){var l={url:g.urls[n]};0===g.urls[n].indexOf("turn")&&(l.username=g.username,l.credential=g.credential);e.push(l)}else e.push(c.iceServers[k])}c.iceServers=
e}return new a.mozRTCPeerConnection(c,d)},a.RTCPeerConnection.prototype=a.mozRTCPeerConnection.prototype,a.mozRTCPeerConnection.generateCertificate&&Object.defineProperty(a.RTCPeerConnection,"generateCertificate",{get:function(){return a.mozRTCPeerConnection.generateCertificate}}),a.RTCSessionDescription=a.mozRTCSessionDescription,a.RTCIceCandidate=a.mozRTCIceCandidate);["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(b){var c=a.RTCPeerConnection.prototype[b];a.RTCPeerConnection.prototype[b]=
function(){arguments[0]=new ("addIceCandidate"===b?a.RTCIceCandidate:a.RTCSessionDescription)(arguments[0]);return c.apply(this,arguments)}});var d=a.RTCPeerConnection.prototype.addIceCandidate;a.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?d.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())};var c=function(a){var b=new Map;Object.keys(a).forEach(function(c){b.set(c,a[c]);b[c]=a[c]});return b},k={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",
candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},l=a.RTCPeerConnection.prototype.getStats;a.RTCPeerConnection.prototype.getStats=function(a,d,e){return l.apply(this,[a||null]).then(function(a){48>b.version&&(a=c(a));if(53>b.version&&!d)try{a.forEach(function(a){a.type=k[a.type]||a.type})}catch(r){if("TypeError"!==r.name)throw r;a.forEach(function(b,c){a.set(c,Object.assign({},b,{type:k[b.type]||b.type}))})}return a}).then(d,e)}}},shimSenderGetStats:function(a){if("object"===
typeof a&&a.RTCPeerConnection&&a.RTCRtpSender&&!(a.RTCRtpSender&&"getStats"in a.RTCRtpSender.prototype)){var b=a.RTCPeerConnection.prototype.getSenders;b&&(a.RTCPeerConnection.prototype.getSenders=function(){var a=this,d=b.apply(a,[]);d.forEach(function(b){b._pc=a});return d});var d=a.RTCPeerConnection.prototype.addTrack;d&&(a.RTCPeerConnection.prototype.addTrack=function(){var a=d.apply(this,arguments);a._pc=this;return a});a.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):
Promise.resolve(new Map)}}},shimReceiverGetStats:function(a){if("object"===typeof a&&a.RTCPeerConnection&&a.RTCRtpSender&&!(a.RTCRtpSender&&"getStats"in a.RTCRtpReceiver.prototype)){var b=a.RTCPeerConnection.prototype.getReceivers;b&&(a.RTCPeerConnection.prototype.getReceivers=function(){var a=this,c=b.apply(a,[]);c.forEach(function(b){b._pc=a});return c});e.wrapPeerConnectionEvent(a,"track",function(a){a.receiver._pc=a.srcElement;return a});a.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}},
shimRemoveStream:function(a){!a.RTCPeerConnection||"removeStream"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.removeStream=function(a){var b=this;e.deprecated("removeStream","removeTrack");this.getSenders().forEach(function(c){c.track&&-1!==a.getTracks().indexOf(c.track)&&b.removeTrack(c)})})},shimRTCDataChannel:function(a){a.DataChannel&&!a.RTCDataChannel&&(a.RTCDataChannel=a.DataChannel)},shimGetDisplayMedia:function(a,b){"getDisplayMedia"in a.navigator||(navigator.getDisplayMedia=
function(a){if(!a||!a.video)return a=new DOMException("getDisplayMedia without video constraints is undefined"),a.name="NotFoundError",a.code=8,Promise.reject(a);!0===a.video?a.video={mediaSource:b}:a.video.mediaSource=b;return navigator.mediaDevices.getUserMedia(a)})}}},{"../utils":11,"./getusermedia":9}],9:[function(m,p,q){var e=m("../utils"),a=e.log;p.exports=function(b){var d=e.detectBrowser(b),c=b&&b.navigator;b=b&&b.MediaStreamTrack;var k=function(a){return{name:{InternalError:"NotReadableError",
NotSupportedError:"TypeError",PermissionDeniedError:"NotAllowedError",SecurityError:"NotAllowedError"}[a.name]||a.name,message:{"The operation is insecure.":"The request is not allowed by the user agent or the platform in the current context."}[a.message]||a.message,constraint:a.constraint,toString:function(){return this.name+(this.message&&": ")+this.message}}},l=function(b,e,f){var h=function(a){if("object"!==typeof a||a.require)return a;var b=[];Object.keys(a).forEach(function(c){if("require"!==
c&&"advanced"!==c&&"mediaSource"!==c){var d=a[c]="object"===typeof a[c]?a[c]:{ideal:a[c]};void 0===d.min&&void 0===d.max&&void 0===d.exact||b.push(c);void 0!==d.exact&&("number"===typeof d.exact?d.min=d.max=d.exact:a[c]=d.exact,delete d.exact);if(void 0!==d.ideal){a.advanced=a.advanced||[];var e={};e[c]="number"===typeof d.ideal?{min:d.ideal,max:d.ideal}:d.ideal;a.advanced.push(e);delete d.ideal;Object.keys(d).length||delete a[c]}}});b.length&&(a.require=b);return a};b=JSON.parse(JSON.stringify(b));
38>d.version&&(a("spec: "+JSON.stringify(b)),b.audio&&(b.audio=h(b.audio)),b.video&&(b.video=h(b.video)),a("ff37: "+JSON.stringify(b)));return c.mozGetUserMedia(b,e,function(a){f(k(a))})},g=function(a){return new Promise(function(b,c){l(a,b,c)})};c.mediaDevices||(c.mediaDevices={getUserMedia:g,addEventListener:function(){},removeEventListener:function(){}});c.mediaDevices.enumerateDevices=c.mediaDevices.enumerateDevices||function(){return new Promise(function(a){a([{kind:"audioinput",deviceId:"default",
label:"",groupId:""},{kind:"videoinput",deviceId:"default",label:"",groupId:""}])})};if(41>d.version){var n=c.mediaDevices.enumerateDevices.bind(c.mediaDevices);c.mediaDevices.enumerateDevices=function(){return n().then(void 0,function(a){if("NotFoundError"===a.name)return[];throw a;})}}if(49>d.version){var f=c.mediaDevices.getUserMedia.bind(c.mediaDevices);c.mediaDevices.getUserMedia=function(a){return f(a).then(function(b){if(a.audio&&!b.getAudioTracks().length||a.video&&!b.getVideoTracks().length)throw b.getTracks().forEach(function(a){a.stop()}),
new DOMException("The object can not be found here.","NotFoundError");return b},function(a){return Promise.reject(k(a))})}}if(!(55<d.version&&"autoGainControl"in c.mediaDevices.getSupportedConstraints())){var h=function(a,b,c){b in a&&!(c in a)&&(a[c]=a[b],delete a[b])},m=c.mediaDevices.getUserMedia.bind(c.mediaDevices);c.mediaDevices.getUserMedia=function(a){"object"===typeof a&&"object"===typeof a.audio&&(a=JSON.parse(JSON.stringify(a)),h(a.audio,"autoGainControl","mozAutoGainControl"),h(a.audio,
"noiseSuppression","mozNoiseSuppression"));return m(a)};if(b&&b.prototype.getSettings){var p=b.prototype.getSettings;b.prototype.getSettings=function(){var a=p.apply(this,arguments);h(a,"mozAutoGainControl","autoGainControl");h(a,"mozNoiseSuppression","noiseSuppression");return a}}if(b&&b.prototype.applyConstraints){var q=b.prototype.applyConstraints;b.prototype.applyConstraints=function(a){"audio"===this.kind&&"object"===typeof a&&(a=JSON.parse(JSON.stringify(a)),h(a,"autoGainControl","mozAutoGainControl"),
h(a,"noiseSuppression","mozNoiseSuppression"));return q.apply(this,[a])}}}c.getUserMedia=function(a,b,k){if(44>d.version)return l(a,b,k);e.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia");c.mediaDevices.getUserMedia(a).then(b,k)}}},{"../utils":11}],10:[function(m,p,q){var e=m("../utils");p.exports={shimLocalStreamsAPI:function(a){if("object"===typeof a&&a.RTCPeerConnection){"getLocalStreams"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.getLocalStreams=
function(){this._localStreams||(this._localStreams=[]);return this._localStreams});"getStreamById"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.getStreamById=function(a){var b=null;this._localStreams&&this._localStreams.forEach(function(c){c.id===a&&(b=c)});this._remoteStreams&&this._remoteStreams.forEach(function(c){c.id===a&&(b=c)});return b});if(!("addStream"in a.RTCPeerConnection.prototype)){var b=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addStream=
function(a){this._localStreams||(this._localStreams=[]);-1===this._localStreams.indexOf(a)&&this._localStreams.push(a);var c=this;a.getTracks().forEach(function(d){b.call(c,d,a)})};a.RTCPeerConnection.prototype.addTrack=function(a,c){c&&(this._localStreams?-1===this._localStreams.indexOf(c)&&this._localStreams.push(c):this._localStreams=[c]);return b.call(this,a,c)}}"removeStream"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.removeStream=function(a){this._localStreams||(this._localStreams=
[]);var b=this._localStreams.indexOf(a);if(-1!==b){this._localStreams.splice(b,1);var d=this,e=a.getTracks();this.getSenders().forEach(function(a){-1!==e.indexOf(a.track)&&d.removeTrack(a)})}})}},shimRemoteStreamsAPI:function(a){if("object"===typeof a&&a.RTCPeerConnection&&("getRemoteStreams"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in a.RTCPeerConnection.prototype))){Object.defineProperty(a.RTCPeerConnection.prototype,
"onaddstream",{get:function(){return this._onaddstream},set:function(a){this._onaddstream&&this.removeEventListener("addstream",this._onaddstream);this.addEventListener("addstream",this._onaddstream=a)}});var b=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(){var a=this;this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(b){b.streams.forEach(function(b){a._remoteStreams||(a._remoteStreams=[]);if(!(0<=a._remoteStreams.indexOf(b))){a._remoteStreams.push(b);
var c=new Event("addstream");c.stream=b;a.dispatchEvent(c)}})});return b.apply(a,arguments)}}},shimCallbacksAPI:function(a){if("object"===typeof a&&a.RTCPeerConnection){a=a.RTCPeerConnection.prototype;var b=a.createOffer,d=a.createAnswer,c=a.setLocalDescription,e=a.setRemoteDescription,l=a.addIceCandidate;a.createOffer=function(a,c){var d=b.apply(this,[2<=arguments.length?arguments[2]:arguments[0]]);if(!c)return d;d.then(a,c);return Promise.resolve()};a.createAnswer=function(a,b){var c=d.apply(this,
[2<=arguments.length?arguments[2]:arguments[0]]);if(!b)return c;c.then(a,b);return Promise.resolve()};var g=function(a,b,d){a=c.apply(this,[a]);if(!d)return a;a.then(b,d);return Promise.resolve()};a.setLocalDescription=g;g=function(a,b,c){a=e.apply(this,[a]);if(!c)return a;a.then(b,c);return Promise.resolve()};a.setRemoteDescription=g;g=function(a,b,c){a=l.apply(this,[a]);if(!c)return a;a.then(b,c);return Promise.resolve()};a.addIceCandidate=g}},shimGetUserMedia:function(a){var b=a&&a.navigator;b.getUserMedia||
(b.webkitGetUserMedia?b.getUserMedia=b.webkitGetUserMedia.bind(b):b.mediaDevices&&b.mediaDevices.getUserMedia&&(b.getUserMedia=function(a,c,e){b.mediaDevices.getUserMedia(a).then(c,e)}.bind(b)))},shimRTCIceServerUrls:function(a){var b=a.RTCPeerConnection;a.RTCPeerConnection=function(a,c){if(a&&a.iceServers){for(var d=[],l=0;l<a.iceServers.length;l++){var g=a.iceServers[l];!g.hasOwnProperty("urls")&&g.hasOwnProperty("url")?(e.deprecated("RTCIceServer.url","RTCIceServer.urls"),g=JSON.parse(JSON.stringify(g)),
g.urls=g.url,delete g.url,d.push(g)):d.push(a.iceServers[l])}a.iceServers=d}return new b(a,c)};a.RTCPeerConnection.prototype=b.prototype;"generateCertificate"in a.RTCPeerConnection&&Object.defineProperty(a.RTCPeerConnection,"generateCertificate",{get:function(){return b.generateCertificate}})},shimTrackEventTransceiver:function(a){"object"===typeof a&&a.RTCPeerConnection&&"receiver"in a.RTCTrackEvent.prototype&&!a.RTCTransceiver&&Object.defineProperty(a.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},
shimCreateOfferLegacy:function(a){var b=a.RTCPeerConnection.prototype.createOffer;a.RTCPeerConnection.prototype.createOffer=function(a){if(a){"undefined"!==typeof a.offerToReceiveAudio&&(a.offerToReceiveAudio=!!a.offerToReceiveAudio);var c=this.getTransceivers().find(function(a){return a.sender.track&&"audio"===a.sender.track.kind});!1===a.offerToReceiveAudio&&c?"sendrecv"===c.direction?c.setDirection?c.setDirection("sendonly"):c.direction="sendonly":"recvonly"===c.direction&&(c.setDirection?c.setDirection("inactive"):
c.direction="inactive"):!0!==a.offerToReceiveAudio||c||this.addTransceiver("audio");"undefined"!==typeof a.offerToReceiveVideo&&(a.offerToReceiveVideo=!!a.offerToReceiveVideo);c=this.getTransceivers().find(function(a){return a.sender.track&&"video"===a.sender.track.kind});!1===a.offerToReceiveVideo&&c?"sendrecv"===c.direction?c.setDirection("sendonly"):"recvonly"===c.direction&&c.setDirection("inactive"):!0!==a.offerToReceiveVideo||c||this.addTransceiver("video")}return b.apply(this,arguments)}}}},
{"../utils":11}],11:[function(m,p,q){function e(a,b,e){return(a=a.match(b))&&a.length>=e&&parseInt(a[e],10)}var a=!0,b=!0;p.exports={extractVersion:e,wrapPeerConnectionEvent:function(a,b,e){if(a.RTCPeerConnection){a=a.RTCPeerConnection.prototype;var c=a.addEventListener;a.addEventListener=function(a,d){if(a!==b)return c.apply(this,arguments);var f=function(a){(a=e(a))&&d(a)};this._eventMap=this._eventMap||{};this._eventMap[d]=f;return c.apply(this,[a,f])};var d=a.removeEventListener;a.removeEventListener=
function(a,c){if(a!==b||!this._eventMap||!this._eventMap[c])return d.apply(this,arguments);var e=this._eventMap[c];delete this._eventMap[c];return d.apply(this,[a,e])};Object.defineProperty(a,"on"+b,{get:function(){return this["_on"+b]},set:function(a){this["_on"+b]&&(this.removeEventListener(b,this["_on"+b]),delete this["_on"+b]);a&&this.addEventListener(b,this["_on"+b]=a)},enumerable:!0,configurable:!0})}},disableLog:function(b){return"boolean"!==typeof b?Error("Argument type: "+typeof b+". Please use a boolean."):
(a=b)?"adapter.js logging disabled":"adapter.js logging enabled"},disableWarnings:function(a){if("boolean"!==typeof a)return Error("Argument type: "+typeof a+". Please use a boolean.");b=!a;return"adapter.js deprecation warnings "+(a?"disabled":"enabled")},log:function(){"object"!==typeof window||a||"undefined"!==typeof console&&"function"===typeof console.log&&console.log.apply(console,arguments)},deprecated:function(a,c){b&&console.warn(a+" is deprecated, please use "+c+" instead.")},detectBrowser:function(a){var b=
a&&a.navigator,d={browser:null,version:null};if("undefined"===typeof a||!a.navigator)return d.browser="Not a browser.",d;b.mozGetUserMedia?(d.browser="firefox",d.version=e(b.userAgent,/Firefox\/(\d+)\./,1)):b.webkitGetUserMedia?(d.browser="chrome",d.version=e(b.userAgent,/Chrom(e|ium)\/(\d+)\./,2)):b.mediaDevices&&b.userAgent.match(/Edge\/(\d+).(\d+)$/)?(d.browser="edge",d.version=e(b.userAgent,/Edge\/(\d+).(\d+)$/,2)):a.RTCPeerConnection&&b.userAgent.match(/AppleWebKit\/(\d+)\./)?(d.browser="safari",
d.version=e(b.userAgent,/AppleWebKit\/(\d+)\./,1)):d.browser="Not a supported browser.";return d}}},{}]},{},[3]);